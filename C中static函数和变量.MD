# C语言中 static 和 static函数的好处
在C语言中, static作用有三条，分别是：
## 是隐藏功能，对于 static 修饰的函数和全局变量而言.
## 是保持持久性功能,对于static修饰的局部变量而言.
## 是因为存放在静态区,全局和局部的 static 修饰的变量,都默认初始化为0.

下面我逐一给大家介绍:
## 先来介绍它的第一条也是最重要的一条: 隐藏。
当我们同时编译多个文件时, 所有**未加static前缀的全局变量和函数**都具有全局可见性. 为理解这句话，我举例来说明.我们要同时编译两个源文件,一个是a.c, 另一个是main.c
```c
// a.c 文件
char a = 'A';
void msg()
{
    printf("Hello\n");
}

// main.c 文件
int main(void)
{
// extern 变量在使用前必须初始化    
  extern char a; 
  printf("%c",a);
  msg();
  return 0;
}
```
运行结果是：
A Hello
**疑问:为什么在a.c 中定义的全局变量a和函数msg能在main.c中使用？**
前面说过，所有**未加static前缀的全局变量和函数都具有全局可见性**,其它的源文件也能访问.此例中,a是全局变量，msg是函数,并且都没有加static前缀,因此对于另外的源文件main.c是可见的.

## static第二个作用是保持变量内容的持久
**存储在静态数据区的变量会在程序刚开始运行时就完成初始化0**.
**也是唯一的一次初始化**.
共有两种变量存储在静态存储区: 全局变量和static变量,只不过和全局变量比起来,static可以控制变量的可见范围,说到底static还是用来隐藏的.虽然这种用法不常见,但我还是举一个例子.
```c
#include <stdio.h>
int fun(void){
 static int count = 10; // 第一次初始化后,以后再调用fun这个count不会再初始化了
 return count--;
}
int count = 1;
int main(void)
{ 
 printf("global\t\tlocal static\n");
 for(; count <= 10; ++count)
  printf("%d\t\t%d\n", count, fun()); 
 return 0;
}
```
程序的运行结果是:
global          local static
1               10
2               9
3               8
4               7
5               6
6               5
7               4
8               3
9               2
10              1

## static的第三个作用是默认初始化为0。
其实全局变量也具备这一属性,因为全局变量也存储在静态数据区.在静态数据区，内存中所有的字节默认值都是0x00,某些时候这一特点可以减少程序员的工作量.

比如初始化一个稀疏矩阵,我们可以一个一个地把所有元素都置0, 然后把不是0的几个元素赋值.如果定义成静态的,就省去了一开始置0的操作。

再比如要把一个字符数组当字符串来用,但又觉得每次在字符数组末尾加'\0'太麻烦.如果把字符串定义成静态的,就省去了这个麻烦,因为那里本来就是'\0'.不妨做个小实验验证一下.
```c
#include <stdio.h>
int a;
int main(void)
{
 int i;
 static char str[10];
 printf("integer: %d; string: (begin)%s(end)", a, str);
 return 0;
}
```
程序的运行结果如下
integer: 0; string: (begin)(end)

最后对static的三条作用做一句话总结.首先static的最主要功能是隐藏,其次因为static变量存放在静态存储区,所以它具备持久性和默认值0.
以上内容是关于c语言中static的作用.

##  C语言中使用静态函数的好处
**静态函数会被自动分配在一个一直使用的存储区,直到退出应用程序实例,避免了调用函数时压栈出栈,速度快很多.**

关键字 “static”,译成中文就是“静态的”, 所以内部函数又称静态函数. 但此处“static”的含义不是指存储方式,而是指对函数的作用域仅局限于本文件. 
>静态函数又称内部函数时什么鬼？

使用内部函数的好处是:不同的人编写不同的函数时,不用担心自己定义的函数,是否会与其它文件中的函数同名,因为同名也没有关系. 
c语言中static的语义
1. static 变量:
   1). a. 静态局部变量在函数内定义, 生存期为整个源程序, 但作用域与自动变量相同, 只能在定义该变量的函数内使用.
       退出该函数后, 尽管该变量还继续存在, 但不能使用它.
       b. 对基本类型的静态局部变量若在说明时未赋以初值,则系统自动赋予0值. 而对自动变量不赋初值,则其值是不定的.
   2). 全局变量本身就是静态存储方式, 静态全局变量当然也是静态存储方式. 但是他们的作用域, 非静态全局变量的作用域是整个源程序(多个源文件可以共同使用); 而静态全局变量则限制了其作用域, 即只在定义该变量的源文件内有效, 在同一源程序的其它源文件中不能使用它.
2. static函数(也叫内部函数)只能被本文件中的函数调用, 而不能被同一程序其它文件中的函数调用. 区别于一般的非静态函数(外部函数)static在c里面可以用来修饰变量,也可以用来修饰函数.先看用来修饰变量的时候. 变量在c里面可分为存在全局数据区、栈和堆里. 其实我们平时所说的堆栈是栈而不包含堆,不要弄混.

下面是中兴通讯2012校招笔试题的一道问答题：
1. static全局变量与普通的全局变量有什么区别 ?
　　全局变量(外部变量)的说明之前再冠以static 就构成了静态的全局变量。
　　全局变量本身就是静态存储方式， 静态全局变量当然也是静态存储方式。 这两者在存储方式上并无不同。
　　这两者的区别在于非静态全局变量的作用域是整个源程序， 当一个源程序由多个源文件组成时，非静态的全局变量在各个源文件中都是有效的。 而静态全局变量则限制了其作用域， 即只在定义该变量的源文件内有效， 在同一源程序的其它源文件中不能使用它。由于静态全局变量的作用域局限于一个源文件内，只能为该源文件内的函数公用，因此可以避免在其它源文件中引起错误。 
　　static全局变量只初使化一次，防止在其他文件单元中被引用; 　 
2.  static局部变量和普通局部变量有什么区别 ？
 　　把局部变量改变为静态变量后是改变了它的存储方式即改变了它的生存期。把全局变量改变为静态变量后是改变了它的作用域，限制了它的使用范围。  
　　static局部变量只被初始化一次，下一次依据上一次结果值； 　 
3.  static函数与普通函数有什么区别？
　　 static 函数与普通函数作用域不同,仅在本文件. 只在当前源文件中使用的函数应该说明为内部函数(static修饰的函数), 内部函数应该在当前源文件中说明和定义. 对于可在当前源文件以外使用的函数,应该在一个头文件中说明,要使用这些函数的源文件要包含这个看】  头文件.
